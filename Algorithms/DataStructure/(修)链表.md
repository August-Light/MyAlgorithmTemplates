模板题目：[P1160 队列安排](https://www.luogu.com.cn/problem/P1160)

板子：

```cpp
namespace linked_list {
    int head, tail;
    struct Node {
        int val, prev, nxt;
        bool deleted;
    } a[MAXN];
    int get_prev(int u) {
        return a[u].prev;
    }
    int get_nxt(int u) {
        return a[u].nxt;
    }
    void insert(int u, int v) { //把 u 插在 v 后
        a[u].prev = v;
        a[get_nxt(v)].prev = u;
        a[u].nxt = get_nxt(v);
        a[v].nxt = u;
    }
    void init(int n) {
        head = n + 1;
        tail = n + 2;
        a[head].prev = a[head].nxt = tail;
        a[tail].prev = a[tail].nxt = head;
        insert(1, head);
    }
    void del(int u) {
        if (a[u].deleted)
            return;
        a[u].deleted = true;
        a[get_prev(u)].nxt = get_nxt(u);
        a[get_nxt(u)].prev = get_prev(u);
    }
}
```

使用：

```cpp
#include <bits/stdc++.h>
#define debug(x) fprintf(stderr, ""#x"=%d\n",  x)
using namespace std;
typedef long long LL;
typedef unsigned long long uLL;
const int MAXN = 1e5 + 5;
int n;

int main() {
    cin >> n;
    linked_list::init(n);
    for (int i = 2; i <= n; i++) {
        int k, p;
        cin >> k >> p;
        if (!p)
            k = linked_list::get_prev(k);
        linked_list::insert(i, k);
    }
    int m;
    cin >> m;
    while (m--) {
        int x;
        cin >> x;
        linked_list::del(x);
    }
    int u = linked_list::head;
    int v = linked_list::tail;
    while (1) {
        u = linked_list::get_nxt(u);
        if (u == v)
            break;
        cout << u << " ";
    }
    return 0;
}
```