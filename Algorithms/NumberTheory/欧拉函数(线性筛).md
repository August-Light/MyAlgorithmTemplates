模板：[P2158 [SDOI2008] 仪仗队](https://www.luogu.com.cn/problem/P2158)

题解：深进 P315

板子：

```cpp
namespace phi {
    int phi[MAXN];
    vector<int> prime;
    bitset<MAXN> vis;
    void init(int n) {
        vis[0] = vis[1] = 1;
        phi[1] = 1;
        for (int i = 2; i <= n; i++) {
            if (!vis[i])
                prime.push_back(i), phi[i] = i - 1;
            for (auto j : prime) {
                int k = i * j;
                if (k <= n) {
                    vis[k] = 1;
                    if (i % j == 0) {
                        phi[k] = phi[i] * j;
                        break;
                    }
                    phi[k] = phi[i] * (j - 1);
                } else break;
            }
        }
    }
    int getphi(int x) {
        return phi[x];
    }
}
```

使用：

```cpp
#include <bits/stdc++.h>
using namespace std;
typedef long long LL;
typedef unsigned long long uLL;
const int MAXN = 4e4 + 5;


int main() {
    int n;
    cin >> n;
    if (n == 1) {
        puts("0");
        putchar('\n');
        return 0;
    }
    phi::init(n);
    int ans = 0;
    for (int i = 2; i < n; i++)
        ans += phi::getphi(i);
    ans = ans * 2 + 3;
    cout << ans << endl;
    return 0;
}
```